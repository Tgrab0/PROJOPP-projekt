<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Projekt - Dino</title>
  <style>
    :root{
      --bg: #5d5f5f;
      --container-bg: linear-gradient(#fff, #e9e9e9);
      --border: #111;
      --shadow: rgba(0,0,0,0.18);
      --ground: #222;
      --font: system-ui, sans-serif;
    }

    html,body{
      height:100%;
      margin:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background:var(--bg);
      font-family:var(--font);
      overflow: hidden;
    }

    #gameContainer{
      width:800px;
      height:300px;
      border:4px solid var(--border);
      border-radius:12px;
      background:var(--container-bg);
      box-shadow:0 0 20px var(--shadow);
      position:relative;
      overflow:hidden;
      padding:0;
    }

    canvas {
      display:block;
      width:100%;
      height:100%;
      background: linear-gradient(#eaf2f1, #dfe9e8);
    }

    #overlay {
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      pointer-events:none;
    }

    #gameTitle {
      position:absolute;
      top:18%;
      width:100%;
      text-align:center;
      font-size:28px;
      font-weight:bold;
      color:#222;
      pointer-events:none;
      user-select:none;
    }

    .hud {
      position:absolute;
      top:10px;
      right:18px;
      font-weight:700;
      color:#111;
      background:rgba(255,255,255,0.7);
      padding:6px 10px;
      border-radius:8px;
      pointer-events:none;
      user-select:none;
    }

    #menu {
      position:absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255,255,255,0.95);
      border-radius:12px;
      padding:18px 22px;
      box-shadow: 0 6px 24px rgba(0,0,0,0.25);
      text-align:center;
      display:flex;
      flex-direction:column;
      gap:6px;
      align-items:center;
      z-index: 10;
    }

    #menu h2 { margin:0 0 8px 0; font-size:20px; color:#111; }
    #menu p { margin:0 0 12px 0; color:#333; font-size: 14px; }
    #menu button {
      background:#111;
      color:#fff;
      border:none;
      padding:8px 14px;
      border-radius:8px;
      font-weight:700;
      cursor:pointer;
    }

    @media (max-width:860px){
      #gameContainer { width:95%; height:250px; }
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <canvas id="gameCanvas" width="800" height="300"></canvas>
    <div id="overlay"><div id="gameTitle"></div></div>
    <div class="hud" id="scoreHud">Wynik: 0</div>
    <div id="menu">
      <h2 id="menuTitle">Dino Runner</h2>
      <p id="menuText">SPACJA / ↑ skok, ↓ kucaj pod przeszkodami wiszącymi</p>
      <button id="startBtn">Start</button>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const HUD = document.getElementById('scoreHud');
    const menu = document.getElementById('menu');
    const menuTitle = document.getElementById('menuTitle');
    const startBtn = document.getElementById('startBtn');
    const gameTitle = document.getElementById('gameTitle');

    let WIDTH, HEIGHT, GROUND_Y;

    function fitCanvas() {
      const rect = canvas.parentElement.getBoundingClientRect();
      canvas.width = rect.width;
      canvas.height = rect.height;
      WIDTH = canvas.width;
      HEIGHT = canvas.height;
      GROUND_Y = HEIGHT - 40;
    }
    window.addEventListener('resize', fitCanvas);
    fitCanvas();

    let speed = 6;
    let gravity = 0.8;
    let running = false;
    let score = 0;

    const dino = {
      x: 60,
      y: 0,
      w: 40,
      h: 44,
      vy: 0,
      jumping: false,
      ducking: false,
      color: '#222'
    };

    const obstacles = [];
    const clouds = [];
    const particles = [];

    let obstacleTimer = 0;
    let obstacleInterval = 90;
    let cloudTimer = 0;

    function spawnObstacle(){
      const type = Math.random();
      let o;

      if(type < 0.3) {

        const w = 40;
        const h = 15;

        const y = GROUND_Y - 45; 
        o = {x: WIDTH + 50, y: y, w: w, h: h, type: "hang", passed: false};
      } else {

        let w = 20 + Math.random() * 20;
        let h = 25 + Math.random() * 25;
        o = {x: WIDTH + 50, y: GROUND_Y - h, w: w, h: h, type: "ground", passed: false};
      }
      obstacles.push(o);
    }

    function spawnCloud(){
      clouds.push({
        x: WIDTH + 100,
        y: 30 + Math.random() * 60,
        r: 15 + Math.random() * 15,
        vx: 0.5 + Math.random()
      });
    }

    function checkCollision(){

      let dX = dino.x + 5; 
      let dW = dino.w - 10;
      let dH = dino.ducking ? dino.h / 2 : dino.h;
      let dY = dino.ducking ? (GROUND_Y - dH) : dino.y;

      for(let o of obstacles) {
        if (dX < o.x + o.w &&
            dX + dW > o.x &&
            dY < o.y + o.h &&
            dY + dH > o.y) {
          return true;
        }
      }
      return false;
    }

    function update(){
      if(!running) return;


      if(dino.ducking) {
        dino.y = GROUND_Y - dino.h/2;
        dino.vy = 0;
      } else {
        dino.vy += gravity;
        dino.y += dino.vy;
      }

      if(dino.y > GROUND_Y - dino.h) {
        dino.y = GROUND_Y - dino.h;
        dino.vy = 0;
        dino.jumping = false;
      }


      obstacleTimer++;
      if(obstacleTimer > obstacleInterval) {
        spawnObstacle();
        obstacleTimer = 0;
      }

      for(let i = obstacles.length - 1; i >= 0; i--) {
        obstacles[i].x -= speed;
        if(!obstacles[i].passed && obstacles[i].x < dino.x) {
          score++;
          obstacles[i].passed = true;
          if(score % 10 === 0) {
            speed += 0.3;
            if(obstacleInterval > 40) obstacleInterval -= 2;
          }
        }
        if(obstacles[i].x + obstacles[i].w < -50) obstacles.splice(i, 1);
      }


      cloudTimer++;
      if(cloudTimer > 150) { spawnCloud(); cloudTimer = 0; }
      clouds.forEach((c, i) => {
        c.x -= c.vx;
        if(c.x < -100) clouds.splice(i, 1);
      });


      for(let i = particles.length - 1; i >= 0; i--){
        let p = particles[i];
        p.x += p.vx; p.y += p.vy; p.vy += 0.2; p.a -= 0.02;
        if(p.a <= 0) particles.splice(i,1);
      }

      if(checkCollision()) endGame();
    }

    function draw(){
      ctx.clearRect(0,0,WIDTH,HEIGHT);


      ctx.fillStyle = 'rgba(255,255,255,0.8)';
      clouds.forEach(c => {
        ctx.beginPath();
        ctx.ellipse(c.x, c.y, c.r * 1.5, c.r, 0, 0, Math.PI*2);
        ctx.fill();
      });


      ctx.fillStyle = '#111';
      ctx.fillRect(0, GROUND_Y, WIDTH, HEIGHT - GROUND_Y);


      ctx.fillStyle = dino.color;
      if(dino.ducking) {
        ctx.fillRect(dino.x, GROUND_Y - dino.h/2, dino.w, dino.h/2);

        ctx.fillStyle = "#fff";
        ctx.fillRect(dino.x + dino.w - 10, GROUND_Y - dino.h/2 + 5, 5, 5);
      } else {
        ctx.fillRect(dino.x, dino.y, dino.w, dino.h);

        ctx.fillStyle = "#fff";
        ctx.fillRect(dino.x + dino.w - 12, dino.y + 8, 7, 7);
      }


      obstacles.forEach(o => {
        ctx.fillStyle = (o.type === "hang") ? "#d9534f" : "#1b1b1b";
        ctx.fillRect(o.x, o.y, o.w, o.h);
      });


      particles.forEach(p => {
        ctx.fillStyle = `rgba(34,34,34,${p.a})`;
        ctx.fillRect(p.x, p.y, 4, 4);
      });

      HUD.textContent = 'Wynik: ' + score;
    }

    function loop(){
      update();
      draw();
      if(running) requestAnimationFrame(loop);
    }

    function startGame(){
      if(running) return;
      obstacles.length = 0;
      particles.length = 0;
      score = 0;
      speed = 6;
      obstacleInterval = 90;
      dino.y = GROUND_Y - dino.h;
      running = true;
      menu.style.display = 'none';
      gameTitle.style.display = 'none';
      requestAnimationFrame(loop);
    }

    function endGame(){
      running = false;
      menu.style.display = 'flex';
      menuTitle.textContent = 'Koniec gry!';
      document.getElementById('menuText').textContent = 'Wynik: ' + score;
      startBtn.textContent = 'Zagraj ponownie';
      
      for(let i=0; i<15; i++){
        particles.push({
          x: dino.x + 20, y: dino.y + 20,
          vx: (Math.random()-0.5)*8, vy: (Math.random()-1)*8, a: 1
        });
      }
      draw(); 
    }


    function handleJump() {
      if(!running) { startGame(); return; }
      if(!dino.jumping && !dino.ducking) {
        dino.vy = -15;
        dino.jumping = true;
      }
    }

    window.addEventListener('keydown', (e) => {
      if(e.code === 'Space' || e.code === 'ArrowUp') {
        e.preventDefault();
        handleJump();
      }
      if(e.code === 'ArrowDown') {
        e.preventDefault();
        if(!dino.jumping) dino.ducking = true;
      }
    });

    window.addEventListener('keyup', (e) => {
      if(e.code === 'ArrowDown') dino.ducking = false;
    });

    startBtn.addEventListener('click', startGame);
    canvas.addEventListener('mousedown', handleJump);
    

    canvas.addEventListener('touchstart', (e) => {
      e.preventDefault();
      const touchY = e.touches[0].clientY;
      if(touchY > window.innerHeight / 2) {
        if(!dino.jumping) dino.ducking = true;
      } else {
        handleJump();
      }
    }, {passive: false});

    canvas.addEventListener('touchend', () => {
      dino.ducking = false;
      if(!running) startGame();
    });


    draw();
  </script>
</body>
</html>